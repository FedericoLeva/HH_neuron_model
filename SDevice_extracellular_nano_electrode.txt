Device Neuron {
File {
	Grid = "n@node|-2@_msh.tdr"
	Parameter="pp@node@_des.par"
	Plot = "@tdrdat@"
	Current = "@plot@"
}

Electrode {
	{ Name="electrolyte_contact" Voltage=0.0}
	{ Name="nano_contact" Voltage=0.0 }
	{ Name="neuron_contact" Voltage=0.0}
	{ Name="intra_contact" Voltage=0.0}
	{ Name="extra_contact" Voltage=0.0}
}
Physics{}
}

File {
	Output = "@log@"
}

Plot{
	eDensity hDensity
	eCurrent hCurrent
	eTemperature
	ElectricField
	ElectricField/Vector
	eQuasiFermi hQuasiFermi
	Potential Doping SpaceCharge
	eMobility hMobility
	DonorConcentration 
	AcceptorConcentration
	eVelocity hVelocity
	conductionBandEnergy
	valenceBandEnergy
  	eTrappedCharge hTrappedCharge  
	eInterfaceTrappedCharge hInterfaceTrappedCharge
 	BandGap
   	EffectiveBandGap
   	SRHRecombination  
   	NonLocal
}

Math{
	Cylindrical		
   	Method=blocked		
   	Submethod=Super
	Transient=BE   
	RelErrControl		
   	Digits=8		
   	Extrapolate		
   	AvalDerivatives		
  	Iterations=100		
   	Notdamped=50		
   	NumberOfThreads= 2	
   	NonLocalLengthLimit = 5.e-4 
   	ExitOnFailure		
   	CNormPrint		
}

System{
Isource_pset Injm (extra intra ) {
pwl = 
(0	0
1.869537401329863e-006	2.695532e-014
3.271690452326392e-006	2.320369e-014
5.141227853656255e-006	1.518663e-014
6.543380904652785e-006	6.789967e-015
8.412918305982647e-006	-7.397899e-015
1.110893208870062e-005	-3.341203e-014
1.776252462090330e-005	-1.000937e-013
2.559028054114135e-005	-1.772608e-013
3.420081205340528e-005	-2.605085e-013
4.424643215104537e-005	-3.552694e-013
5.611852863007458e-005	-4.633600e-013
6.981710149049289e-005	-5.811703e-013
8.586400112698192e-005	-7.054025e-013
1.045201527368860e-004	-8.197373e-013
1.118264763813881e-004	-8.494643e-013
1.151663189073553e-004	-8.478653e-013
1.190581865304352e-004	-8.283704e-013
1.322435751044022e-004	-7.048998e-013
1.449446024654535e-004	-5.636632e-013
1.578609014766912e-004	-3.983207e-013
1.705619288377425e-004	-2.147259e-013
1.841240427995425e-004	3.833810e-015
1.976861567613425e-004	2.452213e-013
2.123246289740775e-004	5.310378e-013
2.278241877875648e-004	8.622420e-013
2.444001048519870e-004	1.249497e-012
2.624829234677342e-004	1.712689e-012
2.820726436347995e-004	2.266454e-012
3.040303519539038e-004	2.960010e-012
3.272796901741329e-004	3.794280e-012
3.483763118924885e-004	4.660718e-012
3.673202171089705e-004	5.548924e-012
3.838961341733928e-004	6.431040e-012
3.981040630857552e-004	7.280876e-012
4.101592754962441e-004	8.081593e-012
4.207075863554219e-004	8.851121e-012
4.297489956632886e-004	9.568344e-012
4.387904049711552e-004	1.034474e-011
4.489081725299569e-004	1.129131e-011
4.562274086363262e-004	1.203245e-011
4.674215344460664e-004	1.326702e-011
4.790462035561792e-004	1.469191e-011
4.911014159666681e-004	1.634082e-011
5.035871716775331e-004	1.825101e-011
5.167187423389570e-004	2.049957e-011
5.302808563007570e-004	2.309052e-011
5.423360687112459e-004	2.561701e-011
5.528843795704237e-004	2.797958e-011
5.623563321786665e-004	3.019150e-011
5.713977414865332e-004	3.234292e-011
5.800086074940238e-004	3.438022e-011
5.873278436003930e-004	3.605840e-011
5.935707214558238e-004	3.741600e-011
6.011052292123793e-004	3.891659e-011
6.120840833719332e-004	4.071172e-011
6.252156540333571e-004	4.199808e-011
6.372708664438460e-004	4.209864e-011
6.491108072041486e-004	4.102520e-011
6.613812912648238e-004	3.865534e-011
6.753739485270000e-004	3.457345e-011
6.889360624888000e-004	2.963544e-011
7.033592630513487e-004	2.395293e-011
7.160602904124000e-004	1.909475e-011
7.266086012715778e-004	1.542673e-011
7.356500105794445e-004	1.264838e-011
7.446914198873111e-004	1.024408e-011
7.537328291951778e-004	8.215087e-012
7.636353251037932e-004	6.396400e-012
7.741836359629710e-004	4.869116e-012
7.862388483734599e-004	3.551236e-012
8.015231355367573e-004	2.376939e-012
8.226197572551129e-004	1.356271e-012
8.577090362356446e-004	4.291236e-013
9.175545549877130e-004	-4.681382e-013
9.702961092836020e-004	-1.097726e-012
1.064154548765267e-003	-2.065531e-012
1.169637657357045e-003	-2.917722e-012
1.272968049447060e-003	-3.514355e-012
1.375437354936334e-003	-3.905968e-012
1.474892857322982e-003	-4.137015e-012
1.540335438979999e-003	-4.228239e-012
1.607500193838513e-003	-4.284016e-012
1.696622657016145e-003	-4.314774e-012
1.796508702703158e-003	-4.309963e-012
1.814591521318913e-003	-4.306276e-012
1.887783882382678e-003	-4.286117e-012
1.994773892525829e-003	-4.250363e-012
2.134054650197014e-003	-4.215045e-012
2.281731002225503e-003	-4.228070e-012
2.392595902071963e-003	-4.315147e-012
2.487745971454750e-003	-4.496986e-012
2.545438773704948e-003	-4.688199e-012
2.593229080046527e-003	-4.914263e-012
2.642741559589608e-003	-5.234044e-012
2.691608224182126e-003	-5.658148e-012
2.739829073824081e-003	-6.205302e-012
2.788049923466037e-003	-6.895463e-012
2.837131859708741e-003	-7.733638e-012
2.889012327403882e-003	-8.680996e-012
2.906664602719239e-003	-8.980521e-012
2.953378550809883e-003	-9.558481e-012
2.995571794246595e-003	-9.570215e-012
3.045299545439861e-003	-8.648302e-012
3.092013493530506e-003	-6.933736e-012
3.132699835415906e-003	-5.185027e-012
3.169296015947749e-003	-3.753717e-012
3.211058716084084e-003	-2.483006e-012
3.268751518334282e-003	-1.363214e-012
3.384782937785238e-003	-4.390852e-013
3.420948575016704e-003	-3.226649e-013
3.702739165112049e-003	-6.654101e-014
4.014631889754046e-003	-1.868743e-014
4.366194389754059e-003	1.261776e-014
4.805647514754076e-003	4.221183e-014
5.332991264754096e-003	7.055753e-014
5.977522514754120e-003	9.934086e-014
6.768538139754150e-003	1.286264e-013
7.852522514754191e-003	1.575633e-013
9.786116264754265e-003	1.708871e-013
9.991194389754272e-003	1.695602e-013
9.999999999999999e-003	1.694938e-013)
}

Isource_pset Ijm (ely neu ) {
pwl = 
(0	0
1.869537401329863e-006	1.124021e-013
3.271690452326392e-006	9.592830e-014
5.141227853656255e-006	6.067793e-014
6.543380904652785e-006	2.373553e-014
8.412918305982647e-006	-3.870692e-014
1.110893208870062e-005	-1.532722e-013
1.776252462090330e-005	-4.471018e-013
2.559028054114135e-005	-7.871399e-013
3.420081205340528e-005	-1.153963e-012
4.424643215104537e-005	-1.571461e-012
5.611852863007458e-005	-2.047470e-012
6.981710149049289e-005	-2.565602e-012
8.586400112698192e-005	-3.109881e-012
1.045201527368860e-004	-3.604242e-012
1.118264763813881e-004	-3.728611e-012
1.151663189073553e-004	-3.717691e-012
1.190581865304352e-004	-3.626384e-012
1.322435751044022e-004	-3.057778e-012
1.449446024654535e-004	-2.404423e-012
1.578609014766912e-004	-1.636757e-012
1.705619288377425e-004	-7.817724e-013
1.841240427995425e-004	2.386705e-013
1.976861567613425e-004	1.368202e-012
2.123246289740775e-004	2.708178e-012
2.278241877875648e-004	4.263460e-012
2.444001048519870e-004	6.084277e-012
2.624829234677342e-004	8.264040e-012
2.820726436347995e-004	1.087095e-011
3.040303519539038e-004	1.413475e-011
3.272796901741329e-004	1.805562e-011
3.483763118924885e-004	2.211877e-011
3.673202171089705e-004	2.627261e-011
3.838961341733928e-004	3.038551e-011
3.981040630857552e-004	3.433582e-011
4.101592754962441e-004	3.804694e-011
4.207075863554219e-004	4.160374e-011
4.297489956632886e-004	4.491033e-011
4.387904049711552e-004	4.848075e-011
4.489081725299569e-004	5.282148e-011
4.562274086363262e-004	5.621103e-011
4.674215344460664e-004	6.183997e-011
4.790462035561792e-004	6.831069e-011
4.911014159666681e-004	7.576526e-011
5.035871716775331e-004	8.435742e-011
5.167187423389570e-004	9.441293e-011
5.302808563007570e-004	1.059209e-010
5.423360687112459e-004	1.170593e-010
5.528843795704237e-004	1.273960e-010
5.623563321786665e-004	1.369972e-010
5.713977414865332e-004	1.462550e-010
5.800086074940238e-004	1.549334e-010
5.873278436003930e-004	1.620002e-010
5.935707214558238e-004	1.676457e-010
6.011052292123793e-004	1.737795e-010
6.120840833719332e-004	1.808524e-010
6.252156540333571e-004	1.853211e-010
6.372708664438460e-004	1.845174e-010
6.491108072041486e-004	1.784913e-010
6.613812912648238e-004	1.667082e-010
6.753739485270000e-004	1.472934e-010
6.889360624888000e-004	1.243267e-010
7.033592630513487e-004	9.823077e-011
7.160602904124000e-004	7.608086e-011
7.266086012715778e-004	5.941477e-011
7.356500105794445e-004	4.680727e-011
7.446914198873111e-004	3.589727e-011
7.537328291951778e-004	2.668059e-011
7.636353251037932e-004	1.840089e-011
7.741836359629710e-004	1.142260e-011
7.862388483734599e-004	5.368848e-012
8.015231355367573e-004	-6.749744e-014
8.226197572551129e-004	-4.841376e-012
8.577090362356446e-004	-9.192706e-012
9.175545549877130e-004	-1.318420e-011
9.702961092836020e-004	-1.573892e-011
1.064154548765267e-003	-1.938369e-011
1.169637657357045e-003	-2.234685e-011
1.272968049447060e-003	-2.418463e-011
1.375437354936334e-003	-2.512259e-011
1.474892857322982e-003	-2.537895e-011
1.540335438979999e-003	-2.528582e-011
1.607500193838513e-003	-2.503275e-011
1.696622657016145e-003	-2.452741e-011
1.796508702703158e-003	-2.382590e-011
1.814591521318913e-003	-2.369150e-011
1.887783882382678e-003	-2.314182e-011
1.994773892525829e-003	-2.236421e-011
2.134054650197014e-003	-2.150212e-011
2.281731002225503e-003	-2.093603e-011
2.392595902071963e-003	-2.093545e-011
2.487745971454750e-003	-2.146345e-011
2.545438773704948e-003	-2.216424e-011
2.593229080046527e-003	-2.305412e-011
2.642741559589608e-003	-2.435961e-011
2.691608224182126e-003	-2.612535e-011
2.739829073824081e-003	-2.842235e-011
2.788049923466037e-003	-3.132017e-011
2.837131859708741e-003	-3.481387e-011
2.889012327403882e-003	-3.868959e-011
2.906664602719239e-003	-3.988347e-011
2.953378550809883e-003	-4.204170e-011
2.995571794246595e-003	-4.170650e-011
3.045299545439861e-003	-3.724478e-011
3.092013493530506e-003	-2.947647e-011
3.132699835415906e-003	-2.173433e-011
3.169296015947749e-003	-1.547561e-011
3.211058716084084e-003	-9.969216e-012
3.268751518334282e-003	-5.161615e-012
3.384782937785238e-003	-1.261327e-012
3.420948575016704e-003	-7.852916e-013
3.702739165112049e-003	1.525120e-013
4.014631889754046e-003	2.314793e-013
4.366194389754059e-003	2.693785e-013
4.805647514754076e-003	3.191096e-013
5.332991264754096e-003	3.855606e-013
5.977522514754120e-003	4.719752e-013
6.768538139754150e-003	5.749306e-013
7.852522514754191e-003	6.857819e-013
9.786116264754265e-003	7.357546e-013
9.991194389754272e-003	7.297380e-013
9.999999999999999e-003	7.294403e-013)
}

Isource_pset Inm (0 neu) {
pwl = 
(0	0
1.869537401329863e-006	4.808125e-013
3.271690452326392e-006	4.114612e-013
5.141227853656255e-006	2.632531e-013
6.543380904652785e-006	1.080237e-013
8.412918305982647e-006	-1.542719e-013
1.110893208870062e-005	-6.352094e-013
1.776252462090330e-005	-1.868015e-012
2.559028054114135e-005	-3.294718e-012
3.420081205340528e-005	-4.833835e-012
4.424643215104537e-005	-6.585612e-012
5.611852863007458e-005	-8.582968e-012
6.981710149049289e-005	-1.075720e-011
8.586400112698192e-005	-1.304144e-011
1.045201527368860e-004	-1.511689e-011
1.118264763813881e-004	-1.563913e-011
1.151663189073553e-004	-1.559316e-011
1.190581865304352e-004	-1.520997e-011
1.322435751044022e-004	-1.282672e-011
1.449446024654535e-004	-1.008855e-011
1.578609014766912e-004	-6.871400e-012
1.705619288377425e-004	-3.288392e-012
1.841240427995425e-004	9.879191e-013
1.976861567613425e-004	5.721298e-012
2.123246289740775e-004	1.133647e-011
2.278241877875648e-004	1.785378e-011
2.444001048519870e-004	2.548368e-011
2.624829234677342e-004	3.461757e-011
2.820726436347995e-004	4.554120e-011
3.040303519539038e-004	5.921719e-011
3.272796901741329e-004	7.564622e-011
3.483763118924885e-004	9.267132e-011
3.673202171089705e-004	1.100762e-010
3.838961341733928e-004	1.273096e-010
3.981040630857552e-004	1.438615e-010
4.101592754962441e-004	1.594113e-010
4.207075863554219e-004	1.743145e-010
4.297489956632886e-004	1.881692e-010
4.387904049711552e-004	2.031293e-010
4.489081725299569e-004	2.213171e-010
4.562274086363262e-004	2.355194e-010
4.674215344460664e-004	2.591048e-010
4.790462035561792e-004	2.862172e-010
4.911014159666681e-004	3.174519e-010
5.035871716775331e-004	3.534531e-010
5.167187423389570e-004	3.955856e-010
5.302808563007570e-004	4.438039e-010
5.423360687112459e-004	4.904734e-010
5.528843795704237e-004	5.337837e-010
5.623563321786665e-004	5.740122e-010
5.713977414865332e-004	6.128014e-010
5.800086074940238e-004	6.491628e-010
5.873278436003930e-004	6.787713e-010
5.935707214558238e-004	7.024246e-010
6.011052292123793e-004	7.281231e-010
6.120840833719332e-004	7.577547e-010
6.252156540333571e-004	7.764724e-010
6.372708664438460e-004	7.730978e-010
6.491108072041486e-004	7.478398e-010
6.613812912648238e-004	6.984587e-010
6.753739485270000e-004	6.170979e-010
6.889360624888000e-004	5.208551e-010
7.033592630513487e-004	4.115004e-010
7.160602904124000e-004	3.186823e-010
7.266086012715778e-004	2.488443e-010
7.356500105794445e-004	1.960136e-010
7.446914198873111e-004	1.502963e-010
7.537328291951778e-004	1.116748e-010
7.636353251037932e-004	7.697962e-011
7.741836359629710e-004	4.773791e-011
7.862388483734599e-004	2.237043e-011
8.015231355367573e-004	-4.098254e-013
8.226197572551129e-004	-2.041399e-011
8.577090362356446e-004	-3.864722e-011
9.175545549877130e-004	-5.537179e-011
9.702961092836020e-004	-6.607544e-011
1.064154548765267e-003	-8.134470e-011
1.169637657357045e-003	-9.375624e-011
1.272968049447060e-003	-1.014513e-010
1.375437354936334e-003	-1.053754e-010
1.474892857322982e-003	-1.064432e-010
1.540335438979999e-003	-1.060487e-010
1.607500193838513e-003	-1.049838e-010
1.696622657016145e-003	-1.028603e-010
1.796508702703158e-003	-9.991426e-011
1.814591521318913e-003	-9.934992e-011
1.887783882382678e-003	-9.704188e-011
1.994773892525829e-003	-9.377669e-011
2.134054650197014e-003	-9.015572e-011
2.281731002225503e-003	-8.777477e-011
2.392595902071963e-003	-8.776571e-011
2.487745971454750e-003	-8.997243e-011
2.545438773704948e-003	-9.290530e-011
2.593229080046527e-003	-9.663107e-011
2.642741559589608e-003	-1.020981e-010
2.691608224182126e-003	-1.094935e-010
2.739829073824081e-003	-1.191148e-010
2.788049923466037e-003	-1.312534e-010
2.837131859708741e-003	-1.458884e-010
2.889012327403882e-003	-1.621233e-010
2.906664602719239e-003	-1.671241e-010
2.953378550809883e-003	-1.761622e-010
2.995571794246595e-003	-1.747527e-010
3.045299545439861e-003	-1.560513e-010
3.092013493530506e-003	-1.234955e-010
3.132699835415906e-003	-9.105088e-011
3.169296015947749e-003	-6.482320e-011
3.211058716084084e-003	-4.174842e-011
3.268751518334282e-003	-2.160206e-011
3.384782937785238e-003	-5.257878e-012
3.420948575016704e-003	-3.263057e-012
3.702739165112049e-003	6.666885e-013
4.014631889754046e-003	9.974129e-013
4.366194389754059e-003	1.155986e-012
4.805647514754076e-003	1.364032e-012
5.332991264754096e-003	1.641991e-012
5.977522514754120e-003	2.003367e-012
6.768538139754150e-003	2.433692e-012
7.852522514754191e-003	2.896389e-012
9.786116264754265e-003	3.102109e-012
9.991194389754272e-003	3.076505e-012
9.999999999999999e-003	3.075240e-012)
}
	
	Neuron N1 ( "electrolyte_contact"=ely0 "nano_contact"=nano "neuron_contact"=neu "intra_contact"=intra "extra_contact"=extra)
	Resistor_pset Rnjseal (ely0 ely){ resistance = 900e6}
	Resistor_pset Rjseal (ely 0){ resistance = 21.8e3}
	Capacitor_pset Cjm (neu ely){ capacitance = 405.7e-15}
	Capacitor_pset Cnm (neu 0){ capacitance = 1.697e-12}
	Capacitor_pset Cpad (ely stray){capacitance=54e-15}
	Resistor_pset Rpad (nano stray){resistance=0.06}
	Resistor_pset Rstray (stray amp) {resistance=463}
	Capacitor_pset Cload (amp 0){ capacitance=370.7e-12}
	Resistor_pset Ramp (amp 0){resistance=100e9}
	Plot "n@node@_sys_des.plt" (time() v(neu) v(amp) ) 
}



Solve {
 	Coupled{Poisson} 
	Coupled{Poisson Electron Hole Contact Circuit}	
	Transient (
     			InitialTime=0 FinalTime=10e-3
			Plot { Range = (0 10.0e-3) Intervals=19 }
     			InitialStep=1e-6 Increment=1.5
     			MaxStep=1e-3 MinStep=1e-6
  			){Coupled{ Poisson Electron Hole Contact Circuit}}
}



